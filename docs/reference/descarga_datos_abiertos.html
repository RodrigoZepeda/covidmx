<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="es"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Conjunto de funciones para la descarga de datos abiertos de
la Direccion General de Epidemiologia
La funcion de descarga principal es descarga_datos_abiertos llama las siguientes funciones
en orden:
descarga_diccionario()
descarga_db()
pega_db_datos_abiertos_tbl_y_diccionario()


A su vez descarga_diccionario ejecuta las siguientes para obtener el diccionario de datos:
descarga_db_diccionario_ssa()
unzip_db_diccionario_ssa()
parse_db_diccionario_ssa()


A su vez descarga_db ejecuta las siguientes para obtener los datos abiertos:
descarga_db_datos_abiertos_tbl()
unzip_db_datos_abiertos_tbl()
parse_db_datos_abiertos_tbl()


Si en algun momento se interrumpio la descarga o hubo problemas de conexion o detuviste
el proceso de generacion de la base de datos abiertos puedes llamar a las funciones
de read_datos_abiertos()"><title>Descarga de datos abiertos — descarga_datos_abiertos • covidmx</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><link href="../deps/_Playfair%20Display-0.4.1/font.css" rel="stylesheet"><link href="../deps/_Playfair%20Display%20SC-0.4.1/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Descarga de datos abiertos — descarga_datos_abiertos"><meta property="og:description" content="Conjunto de funciones para la descarga de datos abiertos de
la Direccion General de Epidemiologia
La funcion de descarga principal es descarga_datos_abiertos llama las siguientes funciones
en orden:
descarga_diccionario()
descarga_db()
pega_db_datos_abiertos_tbl_y_diccionario()


A su vez descarga_diccionario ejecuta las siguientes para obtener el diccionario de datos:
descarga_db_diccionario_ssa()
unzip_db_diccionario_ssa()
parse_db_diccionario_ssa()


A su vez descarga_db ejecuta las siguientes para obtener los datos abiertos:
descarga_db_datos_abiertos_tbl()
unzip_db_datos_abiertos_tbl()
parse_db_datos_abiertos_tbl()


Si en algun momento se interrumpio la descarga o hubo problemas de conexion o detuviste
el proceso de generacion de la base de datos abiertos puedes llamar a las funciones
de read_datos_abiertos()"><meta property="og:image" content="https://rodrigozepeda.github.io/covidmx/reference/figures/card.png"><meta property="og:image:alt" content="Logo de covidmx presenta una ola ajustada por splines con varios puntos"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@RodZepeda"><meta name="twitter:site" content="@RodZepeda"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Ir al contenido</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">covidmx</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0.0000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Cambiar la navegación">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/covidmx.html">Primeros pasos</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Índice</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-art-culos">Artículos</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-art-culos">
    <a class="dropdown-item" href="../articles/Estudio_de_Caso_CDMX.html">Estudio de caso: Ciudad de México</a>
    <a class="dropdown-item" href="../articles/Instalacion_de_MARIADB.html">Instalación de MariaDB</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Registro de cambios</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Cambiar la navegación" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Buscar" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="http://twitter.com/RodZepeda" aria-label="Twitter">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/RodrigoZepeda/covidmx/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Descarga de datos abiertos</h1>
      <small class="dont-index">Código: <a href="https://github.com/RodrigoZepeda/covidmx/blob/HEAD/R/descarga.R" class="external-link"><code>R/descarga.R</code></a></small>
      <div class="d-none name"><code>descarga_datos_abiertos.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Conjunto de funciones para la descarga de datos abiertos de
la Direccion General de Epidemiologia</p>
<p>La funcion de descarga principal es <code>descarga_datos_abiertos</code> llama las siguientes funciones
en orden:</p><ul><li><p><code>descarga_diccionario()</code></p></li>
<li><p><code>descarga_db()</code></p></li>
<li><p><code>pega_db_datos_abiertos_tbl_y_diccionario()</code></p></li>
</ul><p>A su vez <code>descarga_diccionario</code> ejecuta las siguientes para obtener el diccionario de datos:</p><ul><li><p><code>descarga_db_diccionario_ssa()</code></p></li>
<li><p><code>unzip_db_diccionario_ssa()</code></p></li>
<li><p><code>parse_db_diccionario_ssa()</code></p></li>
</ul><p>A su vez <code>descarga_db</code> ejecuta las siguientes para obtener los datos abiertos:</p><ul><li><p><code>descarga_db_datos_abiertos_tbl()</code></p></li>
<li><p><code>unzip_db_datos_abiertos_tbl()</code></p></li>
<li><p><code>parse_db_datos_abiertos_tbl()</code></p></li>
</ul><p>Si en algun momento se interrumpio la descarga o hubo problemas de conexion o detuviste
el proceso de generacion de la base de datos abiertos puedes llamar a las funciones
de <code><a href="read_datos_abiertos.html">read_datos_abiertos()</a></code></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Uso<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">descarga_datos_abiertos</span><span class="op">(</span></span>
<span>  read_format <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MariaDB"</span>, <span class="st">"tibble"</span><span class="op">)</span>,</span>
<span>  user <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"MariaDB_user"</span><span class="op">)</span>,</span>
<span>  password <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"MariaDB_password"</span><span class="op">)</span>,</span>
<span>  dbname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"MariaDB_dbname"</span><span class="op">)</span>,</span>
<span>  host <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"MariaDB_host"</span><span class="op">)</span>,</span>
<span>  group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"MariaDB_group"</span><span class="op">)</span>,</span>
<span>  port <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"MariaDB_port"</span><span class="op">)</span>,</span>
<span>  tblname <span class="op">=</span> <span class="st">"covidmx"</span>,</span>
<span>  nthreads <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  download_process <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pins"</span>, <span class="st">"download.file"</span><span class="op">)</span>,</span>
<span>  site.covid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"http://datosabiertos.salud.gob.mx"</span>,</span>
<span>    <span class="st">"/gobmx/salud/datos_abiertos/datos"</span>, <span class="st">"_abiertos_covid19.zip"</span><span class="op">)</span>,</span>
<span>  site.covid.dic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"http://datosabiertos.salud."</span>, <span class="st">"gob.mx/gobmx/salud/datos_a"</span>,</span>
<span>    <span class="st">"biertos/diccionario_datos_"</span>, <span class="st">"covid19.zip"</span><span class="op">)</span>,</span>
<span>  unzip_command <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"unzip_command"</span><span class="op">)</span>,</span>
<span>  unzip_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"unzip_args"</span><span class="op">)</span>,</span>
<span>  unzip_args_dict <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>exdir <span class="op">=</span> <span class="st">"."</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  check_unzip_install <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  clear_zip <span class="op">=</span> <span class="va">download_process</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">!=</span> <span class="st">"pins"</span>,</span>
<span>  clear_csv <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  use_dict <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  datos_abiertos_zip_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  datos_abiertos_unzipped_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  datos_abiertos_tbl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  diccionario_zip_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  diccionario_unzipped_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  diccionario <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cache_datos <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  use_cache_on_failure <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cache_diccionario <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  force_download <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show_warnings <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  board_url_name <span class="op">=</span> <span class="st">"datos_abiertos"</span>,</span>
<span>  board_url_name_dict <span class="op">=</span> <span class="st">"diccionario_covid"</span>,</span>
<span>  download_file_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"curl"</span>, destfile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span>, quiet <span class="op">=</span> <span class="va">quiet</span><span class="op">)</span>,</span>
<span>  descarga_db_datos_abiertos_tbl_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  descarga_db_diccionario_ssa_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  prestatement <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"SET sql_mode = 'NO_ENGINE_SUBSTITUTION,"</span>,</span>
<span>    <span class="st">"NO_AUTO_CREATE_USER';"</span><span class="op">)</span>,</span>
<span>  additional_mysqlimport_flags <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"--local"</span><span class="op">)</span>,</span>
<span>  load_data_infile_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>LOW_PRIORITY <span class="op">=</span> <span class="st">""</span>, CONCURRENT <span class="op">=</span> <span class="st">""</span>, LOCAL <span class="op">=</span> <span class="st">"LOCAL"</span>,</span>
<span>    PARTITION <span class="op">=</span> <span class="st">""</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">descarga_db</span><span class="op">(</span></span>
<span>  read_format <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MariaDB"</span>, <span class="st">"tibble"</span><span class="op">)</span>,</span>
<span>  user <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"MariaDB_user"</span><span class="op">)</span>,</span>
<span>  password <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"MariaDB_password"</span><span class="op">)</span>,</span>
<span>  dbname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"MariaDB_dbname"</span><span class="op">)</span>,</span>
<span>  host <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"MariaDB_host"</span><span class="op">)</span>,</span>
<span>  group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"MariaDB_group"</span><span class="op">)</span>,</span>
<span>  port <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"MariaDB_port"</span><span class="op">)</span>,</span>
<span>  tblname <span class="op">=</span> <span class="st">"covidmx"</span>,</span>
<span>  nthreads <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  download_process <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pins"</span>, <span class="st">"download.file"</span><span class="op">)</span>,</span>
<span>  site.covid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"http://datosabiertos.salud.gob.mx"</span>,</span>
<span>    <span class="st">"/gobmx/salud/datos_abiertos/datos"</span>, <span class="st">"_abiertos_covid19.zip"</span><span class="op">)</span>,</span>
<span>  unzip_command <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"unzip_command"</span><span class="op">)</span>,</span>
<span>  unzip_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"unzip_args"</span><span class="op">)</span>,</span>
<span>  check_unzip_install <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  clear_zip <span class="op">=</span> <span class="va">download_process</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">!=</span> <span class="st">"pins"</span>,</span>
<span>  clear_csv <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  force_download <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show_warnings <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  datos_abiertos_zip_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  datos_abiertos_unzipped_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  datos_abiertos_tbl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  board_url_name <span class="op">=</span> <span class="st">"datos_abiertos"</span>,</span>
<span>  cache <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  use_cache_on_failure <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  download_file_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"curl"</span>, destfile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span>, quiet <span class="op">=</span> <span class="va">quiet</span><span class="op">)</span>,</span>
<span>  descarga_db_datos_abiertos_tbl_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  prestatement <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"SET sql_mode = 'NO_ENGINE_SUBSTITUTION,"</span>,</span>
<span>    <span class="st">"NO_AUTO_CREATE_USER';"</span><span class="op">)</span>,</span>
<span>  additional_mysqlimport_flags <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"--local"</span><span class="op">)</span>,</span>
<span>  load_data_infile_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>LOW_PRIORITY <span class="op">=</span> <span class="st">""</span>, CONCURRENT <span class="op">=</span> <span class="st">""</span>, LOCAL <span class="op">=</span> <span class="st">"LOCAL"</span>,</span>
<span>    PARTITION <span class="op">=</span> <span class="st">""</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">descarga_diccionario</span><span class="op">(</span></span>
<span>  download_process <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pins"</span>, <span class="st">"download.file"</span><span class="op">)</span>,</span>
<span>  site.covid.dic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"http://datosabiertos.salud."</span>, <span class="st">"gob.mx/gobmx/salud/datos_a"</span>,</span>
<span>    <span class="st">"biertos/diccionario_datos_"</span>, <span class="st">"covid19.zip"</span><span class="op">)</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  clear_zip <span class="op">=</span> <span class="va">download_process</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">!=</span> <span class="st">"pins"</span>,</span>
<span>  clear_csv <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  diccionario_zip_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  diccionario_unzipped_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  diccionario <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  board_url_name_dict <span class="op">=</span> <span class="st">"diccionario_covid"</span>,</span>
<span>  cache_diccionario <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  use_cache_on_failure <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  force_download <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show_warnings <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  download_file_args_dict <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"curl"</span>, destfile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span>, quiet <span class="op">=</span> <span class="va">quiet</span><span class="op">)</span>,</span>
<span>  unzip_args_dict <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>exdir <span class="op">=</span> <span class="st">"."</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  descarga_db_diccionario_ssa_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">descarga_db_datos_abiertos_tbl</span><span class="op">(</span></span>
<span>  download_process <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pins"</span>, <span class="st">"download.file"</span><span class="op">)</span>,</span>
<span>  site.covid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"http://datosabiertos.salud.gob.mx"</span>,</span>
<span>    <span class="st">"/gobmx/salud/datos_abiertos/datos"</span>, <span class="st">"_abiertos_covid19.zip"</span><span class="op">)</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  board_url_name <span class="op">=</span> <span class="st">"datos_abiertos"</span>,</span>
<span>  cache <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  use_cache_on_failure <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  force_download <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show_warnings <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  download_file_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"curl"</span>, destfile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span>, quiet <span class="op">=</span> <span class="va">quiet</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">descarga_db_diccionario_ssa</span><span class="op">(</span></span>
<span>  download_process <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pins"</span>, <span class="st">"download.file"</span><span class="op">)</span>,</span>
<span>  site.covid.dic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"http://datosabiertos.salud."</span>, <span class="st">"gob.mx/gobmx/salud/datos_a"</span>,</span>
<span>    <span class="st">"biertos/diccionario_datos_"</span>, <span class="st">"covid19.zip"</span><span class="op">)</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  board_url_name_dict <span class="op">=</span> <span class="st">"diccionario_covid"</span>,</span>
<span>  cache_diccionario <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  use_cache_on_failure <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  force_download <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show_warnings <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  download_file_args_dict <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"curl"</span>, destfile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span>, quiet <span class="op">=</span> <span class="va">quiet</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">unzip_db_datos_abiertos_tbl</span><span class="op">(</span></span>
<span>  <span class="va">datos_abiertos_zip_path</span>,</span>
<span>  unzip_command <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"unzip_command"</span><span class="op">)</span>,</span>
<span>  unzip_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"unzip_args"</span><span class="op">)</span>,</span>
<span>  check_unzip_install <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  clear_zip <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">unzip_db_diccionario_ssa</span><span class="op">(</span></span>
<span>  <span class="va">diccionario_zip_path</span>,</span>
<span>  unzip_args_dict <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>exdir <span class="op">=</span> <span class="st">"."</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  clear_zip <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">parse_db_diccionario_ssa</span><span class="op">(</span><span class="va">diccionario_unzipped_path</span>, clear_csv <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">parse_db_datos_abiertos_tbl</span><span class="op">(</span></span>
<span>  <span class="va">datos_abiertos_unzipped_path</span>,</span>
<span>  read_format <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MariaDB"</span>, <span class="st">"tibble"</span><span class="op">)</span>,</span>
<span>  user <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"MariaDB_user"</span><span class="op">)</span>,</span>
<span>  password <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"MariaDB_password"</span><span class="op">)</span>,</span>
<span>  dbname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"MariaDB_dbname"</span><span class="op">)</span>,</span>
<span>  host <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"MariaDB_host"</span><span class="op">)</span>,</span>
<span>  group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"MariaDB_group"</span><span class="op">)</span>,</span>
<span>  port <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"MariaDB_port"</span><span class="op">)</span>,</span>
<span>  tblname <span class="op">=</span> <span class="st">"covidmx"</span>,</span>
<span>  nthreads <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  clear_csv <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  prestatement <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"SET sql_mode = 'NO_ENGINE_SUBSTITUTION,"</span>,</span>
<span>    <span class="st">"NO_AUTO_CREATE_USER';"</span><span class="op">)</span>,</span>
<span>  additional_mysqlimport_flags <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"--local"</span><span class="op">)</span>,</span>
<span>  load_data_infile_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>LOW_PRIORITY <span class="op">=</span> <span class="st">""</span>, CONCURRENT <span class="op">=</span> <span class="st">""</span>, LOCAL <span class="op">=</span> <span class="st">"LOCAL"</span>,</span>
<span>    PARTITION <span class="op">=</span> <span class="st">""</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">pega_db_datos_abiertos_tbl_y_diccionario</span><span class="op">(</span><span class="va">datos_abiertos_tbl</span>, <span class="va">diccionario</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="argumentos">Argumentos<a class="anchor" aria-label="anchor" href="#argumentos"></a></h2>
    <dl><dt>read_format</dt>
<dd><p><code>"MariaDB"</code> o <code>"tibble"</code> establece el formato
de lectura de la base de datos. En la mayoria de los casos <code>"tibble"</code> va a
resultar en un error de memoria.</p></dd>


<dt>user</dt>
<dd><p>Usuario para <code>dbConnect</code> i.e. tu usuario de <code>MariaDB</code>.
Puedes ponerlo como variable ambiental con <code>Sys.setenv("MariaDB_user" = "tu_usuario")</code></p></dd>


<dt>password</dt>
<dd><p>password para <code>dbConnect</code> i.e. tu password de <code>MariaDB</code>
Puedes ponerlo como variable ambiental con <code>Sys.setenv("MariaDB_password" = "tu_passwodrd")</code></p></dd>


<dt>dbname</dt>
<dd><p>Nombre de la base de datos <code>DATABASE</code> para<code>dbConnect</code> puedes ponerlo
con <code>Sys.setenv("MariaDB_dbname" = "covidmx")</code></p></dd>


<dt>host</dt>
<dd><p>(<strong>opcional</strong>) Host para <code>dbConnect</code>. Si no sabes cual tienes seguro es <code>localhost</code>. Puedes
ponerlo con <code>Sys.setenv("MariaDB_host" = "localhost")</code></p></dd>


<dt>group</dt>
<dd><p>(<strong>opcional</strong>)  Grupo de <code>dbConnect</code> i.e. tu grupo de <code>MariaDB</code>. Ponlo como variable ambiental
usando <code>Sys.setenv("MariaDB_group" = "tu_grupo")</code></p></dd>


<dt>port</dt>
<dd><p>Puerto de la conexion con <code>MariaDB</code>. Puedes ponerlo con
<code>Sys.setenv("MariaDB_group" = "tu_grupo")</code></p></dd>


<dt>tblname</dt>
<dd><p>Nombre de la tabla dentro de el <code>DATABASE</code> <code>dbname</code> donde guardar los datos
por default se llama <code>covidmx</code>.</p></dd>


<dt>nthreads</dt>
<dd><p>Número de <code>threads</code> para escribir el archivo en <code>MariaDB</code>.</p></dd>


<dt>download_process</dt>
<dd><p>(<strong>opcional</strong>)  Metodo para descargar ya sea <code>pins</code> o <code>download.file</code>.
Se recomienda <code>pins</code> pues guarda en memoria la fecha de la ultima descarga y analiza
si ha pasado mas de un dia desde la descarga. En caso afirmativo verifica si el
archivo ha cambiado y si hubo cambios entonces lo descarga.</p></dd>


<dt>site.covid</dt>
<dd><p>Sitio web con el vinculo al archivo <code>.zip</code> de los datos abiertos. Puedes
cambiarlo por uno de los historicos, por ejemplo.</p></dd>


<dt>site.covid.dic</dt>
<dd><p>Sitio para descarga del diccionario de datos.</p></dd>


<dt>unzip_command</dt>
<dd><p>Forma de extraer la base de datos de datos abiertos. La forma de
llamarla es con <code>system2(unzip_command, args = c(unzip_args, file_download_data))</code>.</p></dd>


<dt>unzip_args</dt>
<dd><p>Argumentos de extraccion de la base de datos de datos abiertos. La forma de
llamarla es con <code>system2(unzip_command, args = c(unzip_args, file_download_data))</code>.</p></dd>


<dt>unzip_args_dict</dt>
<dd><p>Lista de argumentos para usar <code><a href="https://rdrr.io/r/utils/unzip.html" class="external-link">utils::unzip</a></code> en el diccionario de datos.</p></dd>


<dt>check_unzip_install</dt>
<dd><p>Bandera de verificacion para checar si tienes lo necesario para
unzippear los datos.</p></dd>


<dt>clear_zip</dt>
<dd><p>Si borrar los archivos <code>.zip</code> descargados para el diccionario y los datos
abiertos. No se recomienda si estas usando <code>pins</code>. Ve la nota para mas informacion.</p></dd>


<dt>clear_csv</dt>
<dd><p>Si borrar los archivos <code>.csv</code> que se generan despues de abrir el zip. El
default es que si.</p></dd>


<dt>use_dict</dt>
<dd><p>Si descargar el diccionario de <code>site.covid.dic</code>.</p></dd>


<dt>datos_abiertos_zip_path</dt>
<dd><p>Camino a los datos abiertos si ya los descargaste en <code>zip</code></p></dd>


<dt>datos_abiertos_unzipped_path</dt>
<dd><p>Camino a los datos abiertos <code>csv</code> si ya los descargaste y
descomprimiste el archivo <code>zip</code> en un <code>csv</code></p></dd>


<dt>datos_abiertos_tbl</dt>
<dd><p>Lo que resulta de realizar una descarga de los datos abiertos
usando <code>descarga_db</code></p></dd>


<dt>diccionario_zip_path</dt>
<dd><p>Camino al diccionario si ya losdescargaste en <code>zip</code></p></dd>


<dt>diccionario_unzipped_path</dt>
<dd><p>Camino al diccionario <code>csv</code> si ya lo descargaste y
descomprimiste el archivo <code>zip</code> en un <code>csv</code></p></dd>


<dt>diccionario</dt>
<dd><p>Lo que resulta de realizar una descarga del diccionario
usando <code>descarga_diccionario</code></p></dd>


<dt>quiet</dt>
<dd><p>(<strong>opcional</strong>) Variable para no mostrar mensajes</p></dd>


<dt>cache_datos</dt>
<dd><p>Direccion donde guardar los datos en memoria usando <code>pins</code> para no tener
que volver a descargarlos si nada ha cambiado</p></dd>


<dt>use_cache_on_failure</dt>
<dd><p>Booleana. Establece que si no se pueden descargar datos nuevos
utilice los que tenga en memoria.</p></dd>


<dt>cache_diccionario</dt>
<dd><p>Direccion donde guardar el diccionario en memoria usando <code>pins</code> para no tener
que volver a descargarlo si nada ha cambiado</p></dd>


<dt>force_download</dt>
<dd><p>analiza si cambio el pin y descarga datos nuevos en caso afirmativo</p></dd>


<dt>show_warnings</dt>
<dd><p>si arrojar <code>warnings</code></p></dd>


<dt>board_url_name</dt>
<dd><p>Establece el nombre del <code><a href="https://pins.rstudio.com/reference/board_url.html" class="external-link">pins::board_url</a></code> para los datos abiertos</p></dd>


<dt>board_url_name_dict</dt>
<dd><p>Establece el nombre del <code><a href="https://pins.rstudio.com/reference/board_url.html" class="external-link">pins::board_url</a></code> para los datos abiertos</p></dd>


<dt>download_file_args</dt>
<dd><p>Lista de argumentos adicionales para <code>download.file</code> de los datos
si se elige este metodo para descargar.</p></dd>


<dt>descarga_db_datos_abiertos_tbl_args</dt>
<dd><p>Lista con argumentos adicionales para el
<code><a href="https://pins.rstudio.com/reference/pin_download.html" class="external-link">pins::pin_download</a></code> de datos abiertos</p></dd>


<dt>descarga_db_diccionario_ssa_args</dt>
<dd><p>Lista con argumentos adicionales para el
<code><a href="https://pins.rstudio.com/reference/pin_download.html" class="external-link">pins::pin_download</a></code> de datos abiertos</p></dd>


<dt>prestatement</dt>
<dd><p>Opciones adicionales para <code>MariaDB</code> yo pongo las que me han funcionado
en que sea mas veloz la carta.</p></dd>


<dt>additional_mysqlimport_flags</dt>
<dd><p>La instalacion se hace con el siguiente comando para <code>MariaDB</code>:</p><div class="sourceCode"><pre><code>
mysqlimport --default-character-set=UTF8 --fields-terminated-by=',' --ignore-lines=1
--fields-enclosed-by='\"' --lines-terminated-by='\n' --user={user}" --password={password}
--use-threads={nthreads} {silent_flag} {additional_mysqlimport_flags} {dbname} ./{tblname}.csv
</code></pre></div></dd>


<dt>load_data_infile_options</dt>
<dd><p>Lista de opciones por si la importacion con <code>mysqlimport</code> no
funciona se use un <code>LOAD DATA INFILE</code> como aquí <a href="https://dev.mysql.com/doc/refman/8.0/en/load-data.html" class="external-link">https://dev.mysql.com/doc/refman/8.0/en/load-data.html</a>
Las variables se pasan como lista asi por ejemplo si queremos agregar la variable local se
pone <code>list("LOCAL" = "LOCAL")</code> y si no la queremos <code>list("LOCAL" = "")</code>.</p></dd>


<dt>...</dt>
<dd><p>Parametros adicionales para <code><a href="https://pins.rstudio.com/reference/pin_download.html" class="external-link">pins::pin_download</a></code></p></dd>


<dt>cache</dt>
<dd><p>parametro para el cache de <code><a href="https://pins.rstudio.com/reference/board_url.html" class="external-link">pins::board_url</a></code></p></dd>


<dt>download_file_args_dict</dt>
<dd><p>Lista de argumentos adicionales para <code>download.file</code> del diccionario
si se elige este metodo de descarga.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="valor">Valor<a class="anchor" aria-label="anchor" href="#valor"></a></h2>
    

<p>List of values:</p><ul><li><p>dats        - Tabla conectada mediante <code><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">DBI::dbConnect</a></code> (si <code>MariaDB</code>) o
tibble (si <code>tibble</code>)</p></li>
<li><p>disconnect  - Funcion para cerrar la conexion a la base de datos.</p></li>
<li><p>dict        - Lista de <code>tibble</code>s con el diccionario de datos para cada variable</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="detalles">Detalles<a class="anchor" aria-label="anchor" href="#detalles"></a></h2>
    <p>Necesitas tener una instalacion funcionando de <a href="https://mariadb.com/" class="external-link"><code>MariaDB</code></a>. El programa
se encarga de descargar la base de datos de la DGE, abrir el archivo <code>.zip</code> y crear una
tabla de nombre <code>covidmx</code> dentro de tu database <code>dbname</code>. Asegurate de que tu usuario <code>user</code>
tenga permisos de escritura. Para mas informacion sobre instalacion y uso de <code>MariaDB</code>
consulta <a href="https://rodrigozepeda.github.io/covidmx/articles/Instalacion_de_MARIADB.html">el articulo correspondiente</a>.</p>
<p>Si tienes RAM que te sobre puedes no crear una base de datos en <code>MariaDB</code> sino leer directo
el archivo <code>csv</code>. Esto se logra con <code>read_format = tibble</code>. No lo recomiendo pues puedes
terminar con tu sesion de <code>R</code> si se te acaba la memoria.</p>
<p><em>Windows</em> Para abrir el archivo <code>.zip</code> requieres tambien descargar e instalar <a href="https://www.7-zip.org/" class="external-link"><code>7Zip</code></a>
por default el sistema lo busca en <code>C:\\Program Files\\7-Zip\\7z.exe</code> pero si no esta ese
directorio es necesario que en <code>unzip_command</code> especifiques el camino donde se instalo <code>7z.exe</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="nota">Nota<a class="anchor" aria-label="anchor" href="#nota"></a></h2>
    <p>No te recomiendo borrar el cache con <code>clear_zip</code> o editarlo por cualquier otro medio si
estas usando <code>pins</code> pues puede romperse la dependencia. Si accidentalmente lo borraste
usa <code><a href="https://pins.rstudio.com/reference/board_cache_path.html" class="external-link">pins::board_cache_path()</a></code> para ir al <code>path</code> y borrar manualmente toda la carpeta.</p>
    </div>
    <div class="section level2">
    <h2 id="uso-de-pins">Uso de <code>pins</code><a class="anchor" aria-label="anchor" href="#uso-de-pins"></a></h2>
    


<p>Para almacenar los datos se utiliza un pequenio cambio sobre la libreria <code>pins</code>. Los datos
se descargan y se almacenan en cache junto con informacion sobre cuando fue la descarga. Si
no ha pasado un dia desde la ultima descarga no se descarga nada nuevo. Si los datos que
se tienen no han cambiado respecto a lo que esta en linea tampoco se vuelven a descargar aunque
haya pasado mas de un dia.</p>
<p><strong>Si se te fue el Internet</strong> No te preocupes, <code>pins</code> lee tu descarga mas reciente.</p>
<p>Para ver donde estan descargados tus datos usa <code><a href="https://pins.rstudio.com/reference/board_cache_path.html" class="external-link">pins::board_cache_path()</a></code>. Para borrarlos usa
<code><a href="https://pins.rstudio.com/reference/cache_browse.html" class="external-link">pins::cache_prune()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="ver-tambi-n">Ver también<a class="anchor" aria-label="anchor" href="#ver-tambi-n"></a></h2>
    <div class="dont-index"><p><a href="descarga_datos_red_irag.html">descarga_datos_red_irag</a> <a href="descarga_datos_variantes_GISAID.html">descarga_datos_variantes_GISAID</a> <a href="read_datos_abiertos.html">read_datos_abiertos</a> <a href="casos.html">casos</a></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Ejemplos<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">#Descarga de la base de datos junto con diccionario en MariaDB</span></span></span>
<span class="r-in"><span><span class="va">datos_covid</span> <span class="op">&lt;-</span> <span class="fu">descarga_datos_abiertos</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Luego haces algo con esos datos...</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Cuando terminas cierras la sesión:</span></span></span>
<span class="r-in"><span><span class="va">datos_covid</span><span class="op">$</span><span class="fu">disconnect</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Descarga solo el diccionario</span></span></span>
<span class="r-in"><span><span class="va">diccionario</span> <span class="op">&lt;-</span> <span class="fu">descarga_diccionario</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#O bien descarga solo los datos abiertos</span></span></span>
<span class="r-in"><span><span class="va">datos_abiertos</span> <span class="op">&lt;-</span> <span class="fu">descarga_db</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Pegalos en el formato que se necesita para el resto de funciones</span></span></span>
<span class="r-in"><span><span class="va">datos_covid</span> <span class="op">&lt;-</span> <span class="fu">pega_db_datos_abiertos</span><span class="op">(</span><span class="va">datos_abiertos</span>, <span class="va">diccionario</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Tambien puedes descargar paso por paso</span></span></span>
<span class="r-in"><span><span class="va">datos_abiertos</span> <span class="op">&lt;-</span> <span class="fu">descarga_db_datos_abiertos_tbl</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="co">#Descarga</span></span></span>
<span class="r-in"><span>                     <span class="fu">unzip_db_datos_abiertos_tbl</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="co">#Unzippea</span></span></span>
<span class="r-in"><span>                     <span class="fu">parse_db_datos_abiertos_tbl</span><span class="op">(</span><span class="op">)</span>     <span class="co">#MariaDB</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#O bien el diccionario</span></span></span>
<span class="r-in"><span><span class="va">diccionario</span> <span class="op">&lt;-</span> <span class="fu">descarga_db_diccionario_ssa</span><span class="op">(</span><span class="op">)</span>   <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="co">#Descarga</span></span></span>
<span class="r-in"><span>                    <span class="fu">unzip_db_diccionario_ssa</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="co">#Unzippea</span></span></span>
<span class="r-in"><span>                    <span class="fu">parse_db_diccionario_ssa</span><span class="op">(</span><span class="op">)</span>     <span class="co">#Tibble</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>En esta página</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Desarrollado por Rodrigo Zepeda-Tello.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Sitio creado con <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

    </footer></div>

  

  

  </body></html>

